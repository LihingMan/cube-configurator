/*
Rewrite of logic by Aaron Lee
*/